# Using Torch with Video Data Output

ライトを点灯した状態でAVCaptureVideoDataOutputを利用してフレームごとに画像処理をするサンプルアプリです。

## システム要件

- iOS 15.0+
- Xcode 14.2+

## 使い方

アプリを起動するとカメラのプレビューが表示されます。画面の下部にはライトの点灯・消灯を設定するボタンがあります。さらにその下にはMobileNetV2機械学習モデルを用いて画像分類を行った結果が表示されます。

画像の分類はおよそ1秒ごとに実行されます。暗い場所でライトの有無によって分類結果が変化するか試してみてください。

## 実装の解説

通常、写真やビデオのプレビュー中はライトを点灯できません。この挙動はiOS標準カメラアプリも同様です。

しかし、理由は不明ですがAVCaptureSessionにAVCapturePhotoOutputを追加するとライトが点灯するようになります。iPhoneの実機で確認したところ、iOS 15からiOS 17まで期待どおりライトが点灯しました。

なお、AVCaptureSessionを除去してもプレビュー昨日は動作します。ただし、そのように実装すると`.setTorchModeOn(level: Float)`メソッドの呼び出しは成功するのにライトが点灯しない状態になります。
## ライセンス

MIT
